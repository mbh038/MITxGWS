S0=1368
h0=acos(-sin(phi)*sin(delta)/(cos(phi)*cos(delta)))
h0
Imean=(S0/pi)*(sin(phi)*sin(delta)*h0+cos(phi)*cos(delta)*sin(h0))
print (Imean)
Imean=(S0/pi)*cos(phi)*cos(delta)*(-cos(h0)*h0+sin(h0))
print (Imean)
Imean*24/1000
install.packages("rgexf")
?rgexf
library(rgexf)
?"rgexf"
demo(gexf)
plot(grafo)
phi=(pi/180)*65
delta=(pi/180)*22
S0=1368
h0=acos(-sin(phi)*sin(delta)/(cos(phi)*cos(delta)))
h0
Imean=(S0/pi)*(sin(phi)*sin(delta)*h0+cos(phi)*cos(delta)*sin(h0))
print (Imean)
Imean=(S0/pi)*cos(phi)*cos(delta)*(-cos(h0)*h0+sin(h0))
print (Imean)
Imean*24/1000
phi=(pi/180)*50
delta=(pi/180)*22
S0=1368
h0=acos(-sin(phi)*sin(delta)/(cos(phi)*cos(delta)))
h0
Imean=(S0/pi)*(sin(phi)*sin(delta)*h0+cos(phi)*cos(delta)*sin(h0))
print (Imean)
Imean=(S0/pi)*cos(phi)*cos(delta)*(-cos(h0)*h0+sin(h0))
print (Imean)
Imean*24/1000
sin(90)
-23.44pi/180
-23.44*pi/180
N=10
deltaOdot=asin(sin(-0.4091)*cos((2*pi/365.24)*(N+10)))
N=10
deltaOdot=asin(sin(-0.4091)*cos((2*pi/365.24)*(N+10)+0.0334*sin((2*pi/365.24)*(N-2))))
N==seq(1,365)
deltaOdot=asin(sin(-0.4091)*cos((2*pi/365.24)*(N+10)+0.0334*sin((2*pi/365.24)*(N-2))))
plot(deltaOdot)
N=seq(1,365)
deltaOdot=asin(sin(-0.4091)*cos((2*pi/365.24)*(N+10)+0.0334*sin((2*pi/365.24)*(N-2))))
plot(deltaOdot)
N=seq(1,365)
deltaOdot=asin(sin(-0.4091)*cos((2*pi/365.24)*(N+10)+0.0334*sin((2*pi/365.24)*(N-2))))
plot(180*deltaOdot/pi,typ="l")
N=seq(1,365)
deltaOdot=asin(sin(-0.4091)*cos((2*pi/365.24)*(N+10)+0.0334*sin((2*pi/365.24)*(N-2))))
plot(180*deltaOdot/pi,typ="l",ylab="delta")
phi=50
h0=acos(−tan(phi)*tan(deltaOdot))
plot(h0)
phi=50
h0=acos(−tan(phi)*tan(deltaOdot))
plot(24*h0/(2*pi),type="l")
phi=50
h0=acos(−tan(phi)*tan(deltaOdot))
plot(24*h0/pi,type="l")
phi=60
h0=acos(−tan(phi)*tan(deltaOdot))
plot(24*h0/pi,type="l")
phi=70
h0=acos(−tan(phi)*tan(deltaOdot))
plot(24*h0/pi,type="l")
phi=80
h0=acos(−tan(phi)*tan(deltaOdot))
plot(24*h0/pi,type="l")
phi=0
h0=acos(−tan(phi)*tan(deltaOdot))
plot(24*h0/pi,type="l")
phi=50
h0=acos(−tan(phi)*tan(deltaOdot))
plot(24*h0/pi,type="l")
phi=(pi/180)*50
h0=acos(−tan(phi)*tan(deltaOdot))
plot(24*h0/pi,type="l")
N=180
h=seq{-pi,pi,288}
N=180
h=seq(-pi,pi,288)
h
?seq
N=180
h=seq(-pi,pi,length.out=288)
h
N=seq(1,365)
deltaOdot<-function(N){
asin(sin(-0.4091)*cos((2*pi/365.24)*(N+10)+0.0334*sin((2*pi/365.24)*(N-2))))
}
plot(180*deltaOdot(N)/pi,typ="l",ylab="delta")
phi=(pi/180)*50
h0<-function(phi,N){
acos(−tan(phi)*tan(deltaOdot(N)))
}
h0s<-h0(phi,N)
plot(24*h0s/pi,type="l")
deltaOdot<-function(t){
# t is the time as a fraction of the year 0 <= t <= 1
t<-t*365
asin(sin(-0.4091)*cos((2*pi/365.24)*(t+10)+0.0334*sin((2*pi/365.24)*(t-2))))
}
N=seq(0,1,length.out=365)
plot(180*deltaOdot(N)/pi,typ="l",ylab="delta")
phi=(pi/180)*50
h0<-function(phi,N){
acos(−tan(phi)*tan(deltaOdot(N)))
}
h0s<-h0(phi,N)
plot(24*h0s/pi,type="l")
deltaOdot<-function(t){
# t is the time as a fraction of the year 0 <= t <= 1
t<-t*365
asin(sin(-0.4091)*cos((2*pi/365.24)*(t+10)+0.0334*sin((2*pi/365.24)*(t-2))))
}
N=seq(0,1,length.out=365*288)
plot(180*deltaOdot(N)/pi,typ="l",ylab="delta")
phi=(pi/180)*50
h0<-function(phi,N){
acos(−tan(phi)*tan(deltaOdot(N)))
}
h0s<-h0(phi,N)
plot(24*h0s/pi,type="l")
phi=(pi/180)*50
h0<-function(phi,t){
acos(−tan(phi)*tan(deltaOdot(t)))
}
h0s<-h0(phi,t)
plot(24*h0s/pi,type="l")
deltaOdot<-function(t){
# t is the time as a fraction of the year 0 <= t <= 1
t<-t*365
asin(sin(-0.4091)*cos((2*pi/365.24)*(t+10)+0.0334*sin((2*pi/365.24)*(t-2))))
}
N=seq(0,1,length.out=365*288)
plot(180*deltaOdot(N)/pi,typ="l",ylab="delta")
deltaOdot<-function(t){
# t is the time as a fraction of the year 0 <= t <= 1
t<-t*365
asin(sin(-0.4091)*cos((2*pi/365.24)*(t+10)+0.0334*sin((2*pi/365.24)*(t-2))))
}
t=seq(0,1,length.out=365*288)
plot(180*deltaOdot(t)/pi,typ="l",ylab="delta")
deltaOdot<-function(t){
# t is the time as a fraction of the year 0 <= t <= 1
t<-t*365
asin(sin(-0.4091)*cos((2*pi/365.24)*(t+10)+0.0334*sin((2*pi/365.24)*(t-2))))
}
t=seq(0,1,length.out=365*288)
plot(t,180*deltaOdot(t)/pi,typ="l",ylab="delta")
deltaOdot<-function(t){
# t is the time as a fraction of the year 0 <= t <= 1
t<-t*365
asin(sin(-0.4091)*cos((2*pi/365.24)*(t+10)+0.0334*sin((2*pi/365.24)*(t-2))))
}
t=seq(0,1,length.out=365*288)
plot(365*t,180*deltaOdot(t)/pi,typ="l",ylab="delta")
deltaOdot<-function(t){
# t is the time as a fraction of the year 0 <= t <= 1
#t<-t*365
asin(sin(-0.4091)*cos((2*pi/365.24)*(t+10)+0.0334*sin((2*pi/365.24)*(t-2))))
}
t=seq(1,365,length.out=365*288)
plot(t,180*deltaOdot(t)/pi,typ="l",ylab="delta")
?%
floor(4.3)
solarFlux<-function(S0,phi,t){
h<-pi*(2*(t-floor(t))-1)
delta<-deltaOdot(t)
s0*cosTheta(phi,delta,h))
}
solarFlux<-function(S0,phi,t){
h<-pi*(2*(t-floor(t))-1)
delta<-deltaOdot(t)
s0*cosTheta(phi,delta,h)
}
deltaOdot<-function(t){
# t is the time in day number 1-365
#t<-t*365
asin(sin(-0.4091)*cos((2*pi/365.24)*(t+10)+0.0334*sin((2*pi/365.24)*(t-2))))
}
h0<-function(phi,t){
acos(−tan(phi)*tan(deltaOdot(t)))
}
cosTheta<-function(phi,delta,h){
# theta is the zenith angle
sin(phi)*sin(delta)+cos(phi)*cos(delta)*cos(h)
}
solarFlux<-function(S0,phi,t){
h<-pi*(2*(t-floor(t))-1)
delta<-deltaOdot(t)
s0*cosTheta(phi,delta,h)
}
phi=(pi/180)*50
t=seq(1,365,length.out=365*288)
plot(t,180*deltaOdot(t)/pi,typ="l",ylab="delta")
h0s<-h0(phi,t)
plot(24*h0s/pi,type="l")
phi=(pi/180)*50
t=seq(1,365,length.out=365*288)
plot(t,180*deltaOdot(t)/pi,typ="l",ylab="delta")
h0s<-h0(phi,t)
plot(24*h0s/pi,type="l")
phi=(pi/180)*50
t=seq(1,365,length.out=365*288)
plot(t,180*deltaOdot(t)/pi,typ="l",ylab="delta")
h0s<-h0(phi,t)
plot(t,24*h0s/pi,type="l")
phi=(pi/180)*50
S0=1368
t=seq(1,365,length.out=365*288)
Q<-solarFlux(s0,phi,t)
plot(t,Q,type="l")
phi=(pi/180)*50
S0=1368
t=seq(1,365,length.out=365*288)
Q<-solarFlux(S0,phi,t)
plot(t,Q,type="l")
phi=(pi/180)*50
S0=1368
t=seq(1,365,length.out=365*288)
Q<-solarFlux(S0,phi,t)
plot(t,Q,type="l")
phi=(pi/180)*50
S0=1368
t=seq(1,365,length.out=365*288)
Q<-solarFlux(S0,phi,t)
plot(t,Q,type="l")
deltaOdot<-function(t){
# t is the time in day number 1-365
#t<-t*365
asin(sin(-0.4091)*cos((2*pi/365.24)*(t+10)+0.0334*sin((2*pi/365.24)*(t-2))))
}
h0<-function(phi,t){
acos(−tan(phi)*tan(deltaOdot(t)))
}
cosTheta<-function(phi,delta,h){
# theta is the zenith angle
sin(phi)*sin(delta)+cos(phi)*cos(delta)*cos(h)
}
solarFlux<-function(S0,phi,t){
h<-pi*(2*(t-floor(t))-1)
delta<-deltaOdot(t)
S0*cosTheta(phi,delta,h)
}
phi=(pi/180)*50
S0=1368
t=seq(1,365,length.out=365*288)
Q<-solarFlux(S0,phi,t)
plot(t,Q,type="l")
phi=(pi/180)*50
S0=1368
t=seq(1,365,length.out=365*288)
Q<-solarFlux(S0,phi,t)
plot(t[1:288],Q[1:288],type="l")
t[288]
length(t)
str(t)
head(t)
deltaOdot<-function(t){
# t is the time in day number 1-365
#t<-t*365
asin(sin(-0.4091)*cos((2*pi/365.24)*(t+10)+0.0334*sin((2*pi/365.24)*(t-2))))
}
h0<-function(phi,t){
acos(−tan(phi)*tan(deltaOdot(t)))
}
cosTheta<-function(phi,delta,h){
# theta is the zenith angle
sin(phi)*sin(delta)+cos(phi)*cos(delta)*cos(h)
}
solarFlux<-function(S0,phi,t){
h<-pi*(2*(t-floor(t))-1)
delta<-deltaOdot(t)
max(S0*cosTheta(phi,delta,h),0)
}
phi=(pi/180)*50
S0=1368
t=seq(1,365,length.out=365*288)
Q<-solarFlux(S0,phi,t)
plot(t[1:288],Q[1:288],type="l")
deltaOdot<-function(t){
# t is the time in day number 1-365
#t<-t*365
asin(sin(-0.4091)*cos((2*pi/365.24)*(t+10)+0.0334*sin((2*pi/365.24)*(t-2))))
}
h0<-function(phi,t){
acos(−tan(phi)*tan(deltaOdot(t)))
}
cosTheta<-function(phi,delta,h){
# theta is the zenith angle
sin(phi)*sin(delta)+cos(phi)*cos(delta)*cos(h)
}
solarFlux<-function(S0,phi,t){
h<-pi*(2*(t-floor(t))-1)
delta<-deltaOdot(t)
max(S0*cosTheta(phi,delta,h),0)
}
plot(t[1:288],Q[1:288],type="l")
head(Q)
phi=(pi/180)*50
S0=1368
t=seq(1,365,length.out=365*288)
Q<-solarFlux(S0,phi,t)
plot(Q[1:288],type="l")
summary(Q[1:288])
max(3,2)
deltaOdot<-function(t){
# t is the time in day number 1-365
#t<-t*365
asin(sin(-0.4091)*cos((2*pi/365.24)*(t+10)+0.0334*sin((2*pi/365.24)*(t-2))))
}
h0<-function(phi,t){
acos(−tan(phi)*tan(deltaOdot(t)))
}
cosTheta<-function(phi,delta,h){
# theta is the zenith angle
sin(phi)*sin(delta)+cos(phi)*cos(delta)*cos(h)
}
solarFlux<-function(S0,phi,t){
h<-pi*(2*(t-floor(t))-1)
delta<-deltaOdot(t)
max(S0*cosTheta(phi,delta,h),0.0)
}
phi=(pi/180)*50
S0=1368
t=seq(1,365,length.out=365*288)
Q<-solarFlux(S0,phi,t)
plot(Q[1:288],type="l")
deltaOdot<-function(t){
# t is the time in day number 1-365
#t<-t*365
asin(sin(-0.4091)*cos((2*pi/365.24)*(t+10)+0.0334*sin((2*pi/365.24)*(t-2))))
}
h0<-function(phi,t){
acos(−tan(phi)*tan(deltaOdot(t)))
}
cosTheta<-function(phi,delta,h){
# theta is the zenith angle
sin(phi)*sin(delta)+cos(phi)*cos(delta)*cos(h)
}
solarFlux<-function(S0,phi,t){
h<-pi*(2*(t-floor(t))-1)
delta<-deltaOdot(t)
S0*cosTheta(phi,delta,h)
}
phi=(pi/180)*50
S0=1368
t=seq(1,365,length.out=365*288)
Q<-solarFlux(S0,phi,t)
plot(Q[1:288],type="l")
max(0,Q[1])
max(0,Q[144])
deltaOdot<-function(t){
# t is the time in day number 1-365
#t<-t*365
asin(sin(-0.4091)*cos((2*pi/365.24)*(t+10)+0.0334*sin((2*pi/365.24)*(t-2))))
}
h0<-function(phi,t){
acos(−tan(phi)*tan(deltaOdot(t)))
}
cosTheta<-function(phi,delta,h){
# theta is the zenith angle
sin(phi)*sin(delta)+cos(phi)*cos(delta)*cos(h)
}
solarFlux<-function(S0,phi,t){
h<-pi*(2*(t-floor(t))-1)
delta<-deltaOdot(t)
flux<-max(S0*cosTheta(phi,delta,h),0)
flux
}
phi=(pi/180)*50
S0=1368
t=seq(1,365,length.out=365*288)
Q<-solarFlux(S0,phi,t)
plot(Q[1:288],type="l")
deltaOdot<-function(t){
# t is the time in day number 1-365
#t<-t*365
asin(sin(-0.4091)*cos((2*pi/365.24)*(t+10)+0.0334*sin((2*pi/365.24)*(t-2))))
}
h0<-function(phi,t){
acos(−tan(phi)*tan(deltaOdot(t)))
}
cosTheta<-function(phi,delta,h){
# theta is the zenith angle
sin(phi)*sin(delta)+cos(phi)*cos(delta)*cos(h)
}
solarFlux<-function(S0,phi,t){
h<-pi*(2*(t-floor(t))-1)
delta<-deltaOdot(t)
flux<-max(S0*cosTheta(phi,delta,h),rep(0,length(t)))
flux
}
phi=(pi/180)*50
S0=1368
t=seq(1,365,length.out=365*288)
Q<-solarFlux(S0,phi,t)
plot(Q[1:288],type="l")
head(Q)
deltaOdot<-function(t){
# t is the time in day number 1-365
#t<-t*365
asin(sin(-0.4091)*cos((2*pi/365.24)*(t+10)+0.0334*sin((2*pi/365.24)*(t-2))))
}
h0<-function(phi,t){
acos(−tan(phi)*tan(deltaOdot(t)))
}
cosTheta<-function(phi,delta,h){
# theta is the zenith angle
sin(phi)*sin(delta)+cos(phi)*cos(delta)*cos(h)
}
solarFlux<-function(S0,phi,t){
h<-pi*(2*(t-floor(t))-1)
delta<-deltaOdot(t)
flux<-S0*cosTheta(phi,delta,h)
flux<-max(flux,rep(0,length(t)))
flux
}
phi=(pi/180)*50
S0=1368
t=seq(1,365,length.out=365*288)
Q<-solarFlux(S0,phi,t)
plot(Q[1:288],type="l")
length(Q)
rep(0,100)
deltaOdot<-function(t){
# t is the time in day number 1-365
#t<-t*365
asin(sin(-0.4091)*cos((2*pi/365.24)*(t+10)+0.0334*sin((2*pi/365.24)*(t-2))))
}
h0<-function(phi,t){
acos(−tan(phi)*tan(deltaOdot(t)))
}
cosTheta<-function(phi,delta,h){
# theta is the zenith angle
sin(phi)*sin(delta)+cos(phi)*cos(delta)*cos(h)
}
solarFlux<-function(S0,phi,t){
h<-pi*(2*(t-floor(t))-1)
delta<-deltaOdot(t)
flux<-S0*cosTheta(phi,delta,h)
flux<-pmax(flux,rep(0,length(t)))
flux
}
phi=(pi/180)*50
S0=1368
t=seq(1,365,length.out=365*288)
Q<-solarFlux(S0,phi,t)
plot(Q[1:288],type="l")
phi=(pi/180)*50
S0=1368
t=seq(1,365,length.out=365*288)
Q<-solarFlux(S0,phi,t)
plot(t[1:288],Q[1:288],type="l")
tail(t)
t[288]
t[144]
phi=(pi/180)*50
S0=1368
t=seq(0,365,length.out=365*288)
Q<-solarFlux(S0,phi,t)
plot(t[1:288],Q[1:288],type="l")
t[2]-t[1]
phi=(pi/180)*50
S0=1368
t=seq(1,365,length.out=365*288)
Q<-solarFlux(S0,phi,t)
plot(t[1:288],Q[1:288],type="l")
t[2]-t[1]
phi=(pi/180)*50
S0=1368
t=seq(1,366,length.out=365*288)
Q<-solarFlux(S0,phi,t)
plot(t[1:288],Q[1:288],type="l")
t[2]-t[1]
phi=(pi/180)*50
S0=1368
t=seq(1,366,length.out=365*288)
Q<-solarFlux(S0,phi,t)
plot(t,Q,type="l")
length(t>0)
length(t[t>0])
sum(t[t>0])
sum(t[t=!0])
sum(t[t[:]=!0])
sum(t[t[]=!0])
sum(t[t[]!=0])
sum(t[t!=0])
day<-180
phi=(pi/180)*50
S0=1368
t=seq(1,366,length.out=365*288)
Q<-solarFlux(S0,phi,t)
plot(t[day*288:(day+1)*288],Q[day*288:(day+1)*288],type="l")
plot(t[day*288:(day+1)*288],Q[day*288:(day+1)*288],type="l")
t[day*288:(day+1)*288]
length(t)
summary(t)
day
Q[day*288:(day+1)*288]
day<-180
phi=(pi/180)*50
S0=1368
t=seq(1,366,length.out=365*288)
daybegin<-day*288
dayend<-(day+1)*288
Q<-solarFlux(S0,phi,t)
plot(t[daybegin:dayend],Q[daybegin:dayend],type="l")
